--사원 번호가 7788인 사원과 담당업무가 같은 사원을 표시(사원이름과 담당업무)하세요.
SELECT ENAME, JOB
FROM EMPLOYEE
WHERE JOB = (
    SELECT JOB
    FROM EMPLOYEE
    WHERE ENO = 7788
)
AND ENO <> 7788;
--사원번호가 7499인 사원보다 급여가 많은 사원을 표시(사원이름과 담당업무)하세요
SELECT ENAME, JOB
FROM EMPLOYEE
WHERE SALARY > (SELECT SALARY
                            FROM EMPLOYEE
                            WHERE ENO = 7499);

--최소 급여를 받는 사원의 이름, 담당업무 및 급여를 표시하세요.(그룹함수)
SELECT ENAME, JOB, SALARY
FROM EMPLOYEE
WHERE SALARY = (SELECT MIN(SALARY)
                            FROM EMPLOYEE);
                            
--평균 급여가 가장 적은 업무를 찾아 직급과 평균 급여를 표시하세요. (having 절 사용)
SELECT 
    JOB,
    AVG(SALARY) AS 평균급여
FROM 
    EMPLOYEE
GROUP BY 
    JOB
HAVING 
    AVG(SALARY) = (SELECT MIN(AVG_SALARY) 
                   FROM (SELECT AVG(SALARY) AS AVG_SALARY 
                         FROM EMPLOYEE
                         GROUP BY JOB));
                         
-- 각 부서의 최소급여를 받는 사원 이름,급여,부서번호를 표시하세요.
SELECT ENAME, SALARY, DNO
FROM EMPLOYEE
WHERE (DNO, SALARY) IN (
    SELECT DNO, MIN(SALARY)
    FROM EMPLOYEE
    GROUP BY DNO
);

--담당업무가 분석가(ANALYST)인 사원보다 급여가 적으면서 업무가 분석가(ANALYST)아닌 사원(사원번호, 이름, 담당업무,급여)들을 표시하세요.
SELECT ENO, ENAME, JOB, SALARY
FROM EMPLOYEE
WHERE JOB <> 'ANALYST'
AND SALARY < ANY (
    SELECT SALARY
    FROM EMPLOYEE
    WHERE JOB = 'ANALYST'
);

--매니저 없는 사원의 이름을 표시하세요.
SELECT ENAME 
FROM EMPLOYEE
WHERE MANAGER IS NULL;

--매니저 있는 사원의 이름을 표시하세요.
SELECT ENAME 
FROM EMPLOYEE
WHERE MANAGER IS NOT NULL;

-- BLAKE와 동일한 부서에 속한 사원의 이름과 입사일을 표시하는 질의를 작성하세요.(단 BLAKE는 제외)
-- <> BLAKE
SELECT ENAME, HIREDATE
FROM EMPLOYEE
WHERE DNO = (
    SELECT DNO
    FROM EMPLOYEE
    WHERE ENAME = 'BLAKE'
)
AND ENAME <> 'BLAKE';

--급여가 평균보다 많은 사원들의 사원번호와 이름을 표시하되, 결과를 급여에 대한 오름차순으로 정렬하세요.
SELECT ENO, ENAME
FROM EMPLOYEE
WHERE SALARY > (SELECT AVG(SALARY)
                                    FROM EMPLOYEE)
ORDER BY SALARY ASC;

--이름에 K가 포함된 사원과 같은 부서에서 일하는 사원의 사원번호와 이름을 표시하는 질의를 작성하세요.
--ENAME ='%K%'
--AND ENAME NOT LIKE '%K%';  /본인 제외.
SELECT ENO, ENAME
FROM EMPLOYEE
WHERE DNO IN  (SELECT DNO
                                FROM EMPLOYEE
                                WHERE ENAME LIKE '%K%')
AND ENAME NOT LIKE '%K%';

--부서위치가 DALLAS인 사원의 이름과 부서번호 및 담당업무를 표시하세요.
SELECT ENAME, DNO, JOB
FROM EMPLOYEE 
WHERE DNO IN (
                        SELECT DNO 
                        FROM DEPARTMENT
                        WHERE LOC = 'DALLAS');
                        
--KING에게 보고하는 사원의 이름과 급여를 표시하세요.
SELECT ENAME, SALARY
FROM EMPLOYEE
WHERE MANAGER IN ( SELECT ENO
                        FROM EMPLOYEE
                        WHERE ENAME = 'KING');
                        
--RESEARCH 부서의 사원에 대한 부서번호, 사원번호 및 담당업무를 출력하세요
SELECT DNO, ENO, JOB
FROM EMPLOYEE
WHERE DNO = (SELECT DNO
                    FROM DEPARTMENT
                    WHERE DNAME = 'RESEARCH');
            
--평균 급여보다 많은 급여를 받고 이름에서 M이 포함된 사원과 같은 부서에서 근무하는 사원의 사원번호, 이름, 급여를 출력하세요.
SELECT ENO, ENAME, SALARY
FROM EMPLOYEE
WHERE SALARY  > (SELECT AVG(SALARY)
                            FROM EMPLOYEE)
        AND DNO IN ( SELECT DNO 
                            FROM EMPLOYEE 
                            WHERE ENAME LIKE '%M%');

--평균급여가 가장 적은 업무를 찾으세요. (having 절 사용)
SELECT JOB, AVG(SALARY) AS AVG_SALARY
FROM EMPLOYEE
GROUP BY JOB
HAVING AVG(SALARY) = (SELECT MIN(AVG_SALARY)
                                    FROM (SELECT AVG(SALARY) AS AVG_SALARY
                                              FROM EMPLOYEE
                                              GROUP BY JOB) 
);

--부하직원을 가진(manager) 사원의 사원번호와 이름을 출력하세요.
SELECT ENO, ENAME
FROM EMPLOYEE
WHERE MANAGER IS NOT NULL;